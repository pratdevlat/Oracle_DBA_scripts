# Complete Oracle Database Guide - Beginner to Professional

## Table of Contents
1. [Oracle Database Architecture](#oracle-database-architecture)
2. [Installation](#installation)
3. [Patching](#patching)
4. [Upgrades and Downgrades](#upgrades-and-downgrades)
5. [Database Administration](#database-administration)
6. [New Features by Version](#new-features-by-version)
7. [Networking](#networking)
8. [Performance Tuning](#performance-tuning)
9. [Backup and Recovery](#backup-and-recovery)
10. [Security](#security)
11. [Troubleshooting](#troubleshooting)

---

## Oracle Database Architecture

### Physical Architecture

#### Database Files
- **Data Files (.dbf)**: Store actual data in tablespaces
- **Control Files**: Store database metadata and structure information
- **Redo Log Files**: Record all changes for recovery purposes
- **Parameter File (PFILE/SPFILE)**: Contains initialization parameters
- **Password File**: Stores privileged user passwords
- **Archive Log Files**: Copies of redo logs for recovery

#### Memory Structures

##### System Global Area (SGA)
- **Database Buffer Cache**: Caches data blocks from data files
- **Shared Pool**: Contains library cache, data dictionary cache, and other structures
- **Redo Log Buffer**: Temporary storage for redo entries
- **Large Pool**: Used for large memory allocations (RMAN, parallel operations)
- **Java Pool**: Memory for Java Virtual Machine (JVM)
- **Streams Pool**: Used for Oracle Streams operations

##### Program Global Area (PGA)
- **Private SQL Area**: Contains bind information and runtime buffers
- **Cursor Area**: Active set and parsing information
- **Session Memory**: User session information
- **Stack Space**: Variables and arrays

#### Process Architecture

##### Background Processes
- **SMON (System Monitor)**: Instance recovery and cleanup
- **PMON (Process Monitor)**: Process cleanup and registration
- **DBWn (Database Writer)**: Writes dirty buffers to data files
- **LGWR (Log Writer)**: Writes redo log buffer to redo log files
- **CKPT (Checkpoint)**: Updates control files and data file headers
- **ARCn (Archiver)**: Archives filled redo log files
- **RECO (Recoverer)**: Resolves distributed transactions
- **MMON (Manageability Monitor)**: AWR and other management tasks

##### Server Processes
- **Dedicated Server**: One-to-one mapping with user sessions
- **Shared Server**: Multiple sessions share server processes
- **Background Processes**: System maintenance tasks

### Logical Architecture

#### Tablespaces and Data Files
- **System Tablespace**: Data dictionary and system objects
- **Sysaux Tablespace**: Auxiliary system objects
- **Users Tablespace**: Default user objects
- **Temp Tablespace**: Temporary operations
- **Undo Tablespace**: Rollback information

#### Schemas and Database Objects
- **Tables**: Primary data storage structures
- **Indexes**: Performance optimization structures
- **Views**: Virtual tables based on queries
- **Sequences**: Number generators
- **Synonyms**: Alternative names for objects
- **Procedures/Functions**: Stored program units
- **Packages**: Collections of procedures and functions
- **Triggers**: Event-driven program units

---

## Installation

### Pre-Installation Requirements

#### Hardware Requirements
- **Memory**: Minimum 1GB RAM (4GB+ recommended)
- **Disk Space**: 4GB for software, additional for databases
- **Swap Space**: 1.5x physical RAM or 2GB minimum
- **CPU**: x86-64 architecture

#### Software Requirements
- **Operating System**: Linux, Windows, AIX, Solaris, HP-UX
- **Kernel Parameters**: Configure shared memory and semaphores
- **Required Packages**: Development tools, libraries
- **User Accounts**: Oracle user with proper groups

### Installation Methods

#### Interactive GUI Installation
```bash
# Extract installation files
unzip linuxx64_12102_database_1of2.zip
unzip linuxx64_12102_database_2of2.zip

# Run installer
./database/runInstaller
```

#### Silent Installation
```bash
# Create response file
cp /database/response/db_install.rsp /tmp/db_install.rsp

# Edit response file with your parameters
vi /tmp/db_install.rsp

# Run silent installation
./runInstaller -silent -responseFile /tmp/db_install.rsp
```

#### Docker Installation
```bash
# Pull Oracle image
docker pull container-registry.oracle.com/database/enterprise:19.3.0.0

# Run container
docker run -d --name oracle19c \
  -p 1521:1521 -p 5500:5500 \
  -e ORACLE_SID=ORCL \
  -e ORACLE_PDB=PDB1 \
  -e ORACLE_PWD=password \
  container-registry.oracle.com/database/enterprise:19.3.0.0
```

### Post-Installation Tasks

#### Environment Setup
```bash
# Add to .bash_profile
export ORACLE_HOME=/u01/app/oracle/product/19.0.0/dbhome_1
export ORACLE_SID=ORCL
export PATH=$ORACLE_HOME/bin:$PATH
export LD_LIBRARY_PATH=$ORACLE_HOME/lib:$LD_LIBRARY_PATH
```

#### Database Creation
```bash
# Using DBCA (Database Configuration Assistant)
dbca -silent -createDatabase \
  -templateName General_Purpose.dbc \
  -gdbname ORCL \
  -sid ORCL \
  -responseFile NO_VALUE \
  -characterSet AL32UTF8 \
  -memoryPercentage 30 \
  -emConfiguration LOCAL
```

---

## Patching

### Oracle Patching Strategy

#### Patch Types
- **Critical Patch Updates (CPU)**: Security fixes
- **Patch Set Updates (PSU)**: Cumulative patches
- **Bundle Patches**: Collection of fixes
- **One-Off Patches**: Individual bug fixes
- **Release Updates (RU)**: New quarterly model
- **Release Update Revisions (RUR)**: Additional fixes

### OPatch Utility

#### Basic OPatch Commands
```bash
# Check OPatch version
opatch version

# List installed patches
opatch lspatches

# Query patch information
opatch query -all

# Check patch conflicts
opatch prereq CheckConflictAgainstOHWithDetail -ph /path/to/patch
```

#### Applying Patches
```bash
# Database shutdown required for most patches
sqlplus / as sysdba
shutdown immediate;
exit

# Apply patch
cd /path/to/patch
opatch apply

# Start database and run post-patch scripts
sqlplus / as sysdba
startup;
@?/rdbms/admin/catbundle.sql psu apply;
```

### Patch Management Best Practices

#### Pre-Patching
- Review patch README thoroughly
- Check My Oracle Support for known issues
- Backup database and Oracle Home
- Test patches in development environment
- Plan maintenance window

#### During Patching
- Follow exact procedures from patch documentation
- Monitor for errors during application
- Verify patch installation success
- Run required post-patch scripts

#### Post-Patching
- Verify database functionality
- Check alert logs for errors
- Update inventory and documentation
- Schedule follow-up testing

---

## Upgrades and Downgrades

### Database Upgrade Methods

#### Database Upgrade Assistant (DBUA)
```bash
# Pre-upgrade checks
cd $ORACLE_HOME/rdbms/admin
sqlplus / as sysdba
@preupgrd.sql

# Run DBUA
dbua
```

#### Manual Upgrade
```bash
# Backup database
rman target /
backup database;

# Copy parameter file to new Oracle Home
# Start database with new Oracle Home
startup upgrade;

# Run upgrade scripts
@catupgrd.sql

# Recompile invalid objects
@utlrp.sql
```

#### Export/Import Upgrade
```bash
# Export from source database
expdp system/password directory=DATA_PUMP_DIR dumpfile=fulldb.dmp full=y

# Import to target database
impdp system/password directory=DATA_PUMP_DIR dumpfile=fulldb.dmp full=y
```

### Upgrade Planning

#### Pre-Upgrade Tasks
- Review upgrade documentation
- Check hardware and software requirements
- Analyze database for deprecated features
- Plan downtime and rollback procedures
- Test upgrade in development environment

#### Upgrade Process
```sql
-- Check database status
SELECT name, open_mode FROM v$database;

-- Gather dictionary statistics
EXEC DBMS_STATS.GATHER_DICTIONARY_STATS;

-- Purge recyclebin
PURGE DBA_RECYCLEBIN;

-- Check for invalid objects
SELECT count(*) FROM dba_objects WHERE status = 'INVALID';
```

### Downgrade Procedures

#### Supported Downgrade Paths
- Limited downgrade support between versions
- Flashback Database can provide point-in-time recovery
- Export/Import may be required for major version downgrades

#### Downgrade Steps
```sql
-- Create guaranteed restore point before upgrade
CREATE RESTORE POINT pre_upgrade_rp GUARANTEE FLASHBACK DATABASE;

-- If downgrade needed
SHUTDOWN IMMEDIATE;
STARTUP MOUNT;
FLASHBACK DATABASE TO RESTORE POINT pre_upgrade_rp;
ALTER DATABASE OPEN RESETLOGS;
```

---

## Database Administration

### Daily Administration Tasks

#### Database Health Checks
```sql
-- Check database status
SELECT name, open_mode, database_role FROM v$database;

-- Check instance status
SELECT instance_name, status, startup_time FROM v$instance;

-- Check tablespace usage
SELECT 
    tablespace_name,
    ROUND(used_space * 8192 / 1024 / 1024, 2) as used_mb,
    ROUND(tablespace_size * 8192 / 1024 / 1024, 2) as total_mb,
    ROUND(used_percent, 2) as used_percent
FROM dba_tablespace_usage_metrics;

-- Check archive log generation
SELECT 
    TO_CHAR(first_time, 'YYYY-MM-DD HH24') as hour,
    COUNT(*) as logs_generated
FROM v$log_history
WHERE first_time > SYSDATE - 1
GROUP BY TO_CHAR(first_time, 'YYYY-MM-DD HH24')
ORDER BY hour;
```

#### User Management
```sql
-- Create user
CREATE USER testuser IDENTIFIED BY password
DEFAULT TABLESPACE users
TEMPORARY TABLESPACE temp
QUOTA 100M ON users;

-- Grant privileges
GRANT CONNECT, RESOURCE to testuser;
GRANT SELECT ON hr.employees TO testuser;

-- Create role
CREATE ROLE app_role;
GRANT SELECT, INSERT, UPDATE, DELETE ON hr.employees TO app_role;
GRANT app_role TO testuser;

-- Check user privileges
SELECT * FROM dba_sys_privs WHERE grantee = 'TESTUSER';
SELECT * FROM dba_tab_privs WHERE grantee = 'TESTUSER';
SELECT * FROM dba_role_privs WHERE grantee = 'TESTUSER';
```

#### Space Management
```sql
-- Add datafile to tablespace
ALTER TABLESPACE users ADD DATAFILE 
'/u01/app/oracle/oradata/orcl/users02.dbf' SIZE 100M AUTOEXTEND ON;

-- Resize datafile
ALTER DATABASE DATAFILE '/u01/app/oracle/oradata/orcl/users01.dbf' 
RESIZE 200M;

-- Create tablespace
CREATE TABLESPACE test_tbs
DATAFILE '/u01/app/oracle/oradata/orcl/test_tbs01.dbf' 
SIZE 100M AUTOEXTEND ON NEXT 10M MAXSIZE 1G;

-- Check datafile information
SELECT 
    file_name, 
    tablespace_name, 
    bytes/1024/1024 as size_mb,
    autoextensible,
    maxbytes/1024/1024 as max_size_mb
FROM dba_data_files;
```

### Memory Management

#### SGA Management
```sql
-- Check SGA components
SELECT component, current_size/1024/1024 as size_mb 
FROM v$sga_info;

-- Automatic Memory Management (AMM)
ALTER SYSTEM SET memory_target = 2G SCOPE=SPFILE;

-- Automatic Shared Memory Management (ASMM)
ALTER SYSTEM SET sga_target = 1G SCOPE=SPFILE;
ALTER SYSTEM SET pga_aggregate_target = 512M SCOPE=SPFILE;

-- Manual memory management
ALTER SYSTEM SET db_cache_size = 400M SCOPE=SPFILE;
ALTER SYSTEM SET shared_pool_size = 200M SCOPE=SPFILE;
```

#### PGA Management
```sql
-- Check PGA usage
SELECT 
    name, 
    value/1024/1024 as value_mb 
FROM v$pgastat 
WHERE name IN ('total PGA allocated', 'total PGA used');

-- PGA advisor
SELECT 
    pga_target_for_estimate/1024/1024 as target_mb,
    estd_pga_cache_hit_percentage,
    estd_overalloc_count
FROM v$pga_target_advice
ORDER BY pga_target_for_estimate;
```

### Job Scheduling

#### DBMS_SCHEDULER
```sql
-- Create job
BEGIN
  DBMS_SCHEDULER.CREATE_JOB (
    job_name        => 'CLEANUP_JOB',
    job_type        => 'PLSQL_BLOCK',
    job_action      => 'BEGIN DELETE FROM temp_table WHERE created_date < SYSDATE - 7; COMMIT; END;
/

-- Security policy function example
CREATE OR REPLACE FUNCTION security.employee_security(
  schema_var IN VARCHAR2,
  table_var IN VARCHAR2
) RETURN VARCHAR2
IS
  predicate VARCHAR2(400);
BEGIN
  predicate := 'department_id = SYS_CONTEXT(''USERENV'',''CLIENT_IDENTIFIER'')';
  RETURN predicate;
END;
/
```

### Data Encryption

#### Transparent Data Encryption (TDE)
```sql
-- Create wallet for TDE
ALTER SYSTEM SET ENCRYPTION KEY IDENTIFIED BY "wallet_password";

-- Create encrypted tablespace
CREATE TABLESPACE encrypted_tbs
DATAFILE '/u01/app/oracle/oradata/orcl/encrypted_tbs01.dbf' 
SIZE 100M
ENCRYPTION USING 'AES256'
DEFAULT STORAGE(ENCRYPT);

-- Encrypt existing tablespace
ALTER TABLESPACE users ENCRYPTION ONLINE USING 'AES256' ENCRYPT;

-- Create encrypted table
CREATE TABLE sensitive_data (
  id NUMBER,
  ssn VARCHAR2(11) ENCRYPT USING 'AES256',
  credit_card VARCHAR2(16) ENCRYPT USING 'AES192'
) TABLESPACE encrypted_tbs;
```

#### Network Encryption
```bash
# Configure sqlnet.ora for network encryption
SQLNET.ENCRYPTION_SERVER = REQUIRED
SQLNET.ENCRYPTION_TYPES_SERVER = (AES256, AES192, AES128)
SQLNET.CRYPTO_CHECKSUM_SERVER = REQUIRED
SQLNET.CRYPTO_CHECKSUM_TYPES_SERVER = (SHA256, SHA1)
```

### Auditing

#### Standard Auditing
```sql
-- Enable auditing
ALTER SYSTEM SET audit_trail = DB SCOPE=SPFILE;

-- Audit specific activities
AUDIT SELECT ON hr.employees;
AUDIT CREATE SESSION;
AUDIT DROP TABLE;

-- Check audit records
SELECT username, action_name, object_name, timestamp
FROM dba_audit_trail
WHERE username = 'HR'
ORDER BY timestamp DESC;
```

#### Fine-Grained Auditing (FGA)
```sql
-- Create FGA policy
BEGIN
  DBMS_FGA.ADD_POLICY(
    object_schema   => 'HR',
    object_name     => 'EMPLOYEES',
    policy_name     => 'SALARY_ACCESS_POLICY',
    audit_condition => 'SALARY > 10000',
    audit_column    => 'SALARY',
    statement_types => 'SELECT'
  );
END;
/

-- Check FGA audit trail
SELECT db_user, object_schema, object_name, sql_text, timestamp
FROM dba_fga_audit_trail
ORDER BY timestamp DESC;
```

#### Unified Auditing (12c+)
```sql
-- Create audit policy
CREATE AUDIT POLICY sensitive_data_policy
ACTIONS SELECT, INSERT, UPDATE, DELETE ON hr.employees,
        CREATE SESSION,
        ALTER SYSTEM;

-- Enable audit policy
AUDIT POLICY sensitive_data_policy BY hr;

-- Check unified audit trail
SELECT event_timestamp, dbusername, action_name, object_schema, object_name
FROM unified_audit_trail
WHERE dbusername = 'HR'
ORDER BY event_timestamp DESC;
```

---

## Troubleshooting

### Common Database Issues

#### Startup Problems
```sql
-- Check alert log for startup issues
-- Location: $ORACLE_BASE/diag/rdbms/orcl/orcl/trace/alert_orcl.log

-- Common startup issues and solutions:

-- ORA-00205: Error in identifying control file
-- Solution: Check control_files parameter
SHOW PARAMETER control_files;

-- ORA-00600: Internal error
-- Solution: Check MOS for specific error codes

-- ORA-01157: Cannot identify/lock data file
-- Solution: Check datafile locations
SELECT file_name, status FROM dba_data_files WHERE status != 'AVAILABLE';
```

#### Performance Issues
```sql
-- Check current wait events
SELECT event, count(*), avg_wait_time
FROM v$session_wait_class
WHERE wait_class != 'Idle'
GROUP BY event, avg_wait_time
ORDER BY count(*) DESC;

-- Top SQL by resource consumption
SELECT sql_id, cpu_time, elapsed_time, executions, disk_reads
FROM v$sql
WHERE executions > 0
ORDER BY cpu_time DESC;

-- Check blocking sessions
SELECT 
  s1.username || '@' || s1.machine || ' (SID=' || s1.sid || ')' as blocking_session,
  s2.username || '@' || s2.machine || ' (SID=' || s2.sid || ')' as blocked_session,
  lo.object_id,
  do.object_name
FROM v$lock l1, v$session s1, v$lock l2, v$session s2, v$locked_object lo, dba_objects do
WHERE s1.sid = l1.sid AND s2.sid = l2.sid
  AND l1.block = 1 AND l2.request > 0
  AND l1.id1 = l2.id1 AND l1.id2 = l2.id2
  AND lo.session_id = s2.sid
  AND do.object_id = lo.object_id;
```

#### Space Issues
```sql
-- Check tablespace usage
SELECT 
    tablespace_name,
    ROUND(used_mb, 2) as used_mb,
    ROUND(free_mb, 2) as free_mb,
    ROUND(total_mb, 2) as total_mb,
    ROUND((used_mb/total_mb) * 100, 2) as used_percent
FROM (
    SELECT 
        tablespace_name,
        SUM(bytes)/1024/1024 as total_mb
    FROM dba_data_files
    GROUP BY tablespace_name
) total,
(
    SELECT 
        tablespace_name,
        SUM(bytes)/1024/1024 as free_mb
    FROM dba_free_space
    GROUP BY tablespace_name
) free,
(
    SELECT 
        tablespace_name,
        (total_mb - free_mb) as used_mb
    FROM (
        SELECT tablespace_name, SUM(bytes)/1024/1024 as total_mb FROM dba_data_files GROUP BY tablespace_name
    ) t1,
    (
        SELECT tablespace_name, SUM(bytes)/1024/1024 as free_mb FROM dba_free_space GROUP BY tablespace_name
    ) t2
    WHERE t1.tablespace_name = t2.tablespace_name
) used
WHERE total.tablespace_name = free.tablespace_name
  AND total.tablespace_name = used.tablespace_name;

-- Find large objects
SELECT owner, segment_name, segment_type, bytes/1024/1024 as size_mb
FROM dba_segments
WHERE bytes > 100*1024*1024
ORDER BY bytes DESC;
```

### Diagnostic Tools

#### Automatic Diagnostic Repository (ADR)
```bash
# Use ADRCI utility
adrci

# ADRCI commands
show homes
set home diag/rdbms/orcl/orcl
show incident
show alert
show tracefile
```

#### SQL Trace and TKPROF
```sql
-- Enable SQL trace for session
ALTER SESSION SET sql_trace = TRUE;

-- 10046 trace with bind variables and wait events
ALTER SESSION SET EVENTS '10046 trace name context forever, level 12';

-- Enable trace for another session
EXEC DBMS_SYSTEM.SET_SQL_TRACE_IN_SESSION(sid, serial#, TRUE);

-- Generate TKPROF report
-- tkprof trace_file output_file explain=username/password
```

#### Oracle Support Tools
```bash
# OSWatcher (OS monitoring)
# Download and run OSWatcher to collect OS statistics

# RDA (Remote Diagnostic Agent)
# Collect comprehensive system information for Oracle Support

# SQLT (SQL Tuning tool)
# Comprehensive SQL analysis tool
```

### Emergency Recovery Procedures

#### Database Corruption
```sql
-- Check for block corruption
EXEC DBMS_REPAIR.CHECK_OBJECT('SCOTT', 'EMP');

-- Use RMAN to check for corruption
RMAN> BACKUP VALIDATE DATABASE;
RMAN> BACKUP VALIDATE CHECK LOGICAL DATABASE;

-- Repair corrupt blocks
RMAN> RECOVER CORRUPTION LIST;
```

#### Lost Control File Recovery
```bash
# If all control files lost
# 1. Create new control file
CREATE CONTROLFILE REUSE DATABASE "ORCL"
LOGFILE
  GROUP 1 '/u01/app/oracle/oradata/orcl/redo01.log' SIZE 50M,
  GROUP 2 '/u01/app/oracle/oradata/orcl/redo02.log' SIZE 50M,
  GROUP 3 '/u01/app/oracle/oradata/orcl/redo03.log' SIZE 50M
DATAFILE
  '/u01/app/oracle/oradata/orcl/system01.dbf',
  '/u01/app/oracle/oradata/orcl/sysaux01.dbf',
  '/u01/app/oracle/oradata/orcl/users01.dbf'
CHARACTER SET AL32UTF8;
```

#### Incomplete Recovery
```bash
# When complete recovery is not possible
RMAN TARGET /
STARTUP MOUNT;
SET UNTIL SCN 123456;
RESTORE DATABASE;
RECOVER DATABASE;
ALTER DATABASE OPEN RESETLOGS;
```

---

## Advanced Topics

### Oracle Real Application Clusters (RAC)

#### RAC Architecture
- Shared storage architecture
- Cluster Ready Services (CRS)
- Automatic Storage Management (ASM)
- Cache Fusion technology

#### RAC Administration
```sql
-- Check cluster status
SELECT inst_id, instance_name, status FROM gv$instance;

-- Check RAC services
SELECT name, network_name, failover_type, failover_method 
FROM dba_services;

-- Relocate service
EXEC DBMS_SERVICE.RELOCATE_SERVICE('app_service', 'orcl1', 'orcl2');

-- Check interconnect traffic
SELECT name, value FROM gv$sysstat WHERE name = 'gcs messages sent';
```

### Data Guard

#### Data Guard Configuration
```sql
-- Primary database setup
ALTER DATABASE FORCE LOGGING;
ALTER DATABASE ADD STANDBY LOGFILE GROUP 4 SIZE 50M;
ALTER SYSTEM SET LOG_ARCHIVE_DEST_2='SERVICE=standby ASYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=standby';

-- Physical standby creation
DUPLICATE TARGET DATABASE FOR STANDBY FROM ACTIVE DATABASE;

-- Check Data Guard status
SELECT database_role, open_mode, protection_mode FROM v$database;
SELECT sequence#, applied FROM v$archived_log WHERE dest_id = 2;
```

#### Data Guard Broker
```bash
# Configure Data Guard Broker
dgmgrl sys/password@primary
CREATE CONFIGURATION 'DG_CONFIG' AS PRIMARY DATABASE IS 'primary' CONNECT IDENTIFIER IS primary;
ADD DATABASE 'standby' AS CONNECT IDENTIFIER IS standby;
ENABLE CONFIGURATION;

# Monitor Data Guard
SHOW CONFIGURATION;
SHOW DATABASE primary;
SHOW DATABASE standby;
```

### Automatic Storage Management (ASM)

#### ASM Administration
```sql
-- Connect to ASM instance
export ORACLE_SID=+ASM
sqlplus / as sysasm

-- Check ASM diskgroups
SELECT name, state, total_mb, free_mb FROM v$asm_diskgroup;

-- Add disk to diskgroup
ALTER DISKGROUP data ADD DISK '/dev/raw/raw3';

-- Create diskgroup
CREATE DISKGROUP data EXTERNAL REDUNDANCY
DISK '/dev/raw/raw1', '/dev/raw/raw2';

-- ASM file operations
SELECT name, bytes/1024/1024 as size_mb FROM v$asm_file WHERE type = 'DATAFILE';
```

### Oracle Enterprise Manager (OEM)

#### OEM Cloud Control
- Centralized database management
- Performance monitoring and tuning
- Automated patching and provisioning
- Compliance management

#### Key OEM Features
```sql
-- Database discovery and monitoring
-- Performance analysis with AWR/ASH
-- Incident management and alerting
-- Configuration management
-- Patch management automation
```

### Multitenant Architecture Deep Dive

#### Container Database Management
```sql
-- CDB operations
SELECT name, con_id, open_mode FROM v$containers;

-- Resource management
CREATE PROFILE pdb_profile LIMIT CPU_PER_SESSION 1000;
ALTER PLUGGABLE DATABASE pdb1 SET DEFAULT PROFILE = pdb_profile;

-- Common users and roles
CREATE COMMON USER c##admin IDENTIFIED BY password CONTAINER=ALL;
CREATE COMMON ROLE c##dba_role CONTAINER=ALL;
```

#### PDB Operations
```sql
-- PDB lifecycle management
CREATE PLUGGABLE DATABASE pdb2 FROM pdb1;
ALTER PLUGGABLE DATABASE pdb2 OPEN;
ALTER PLUGGABLE DATABASE pdb2 CLOSE;
DROP PLUGGABLE DATABASE pdb2 INCLUDING DATAFILES;

-- PDB cloning
CREATE PLUGGABLE DATABASE pdb_clone FROM pdb1 
FILE_NAME_CONVERT = ('/u01/pdb1/', '/u01/pdb_clone/');

-- PDB refresh
CREATE PLUGGABLE DATABASE pdb_refresh FROM pdb1@dblink REFRESH MODE MANUAL;
ALTER PLUGGABLE DATABASE pdb_refresh REFRESH;
```

---

## Monitoring and Alerting

### Database Health Monitoring

#### Key Performance Indicators
```sql
-- Database availability
SELECT 
  startup_time,
  ROUND((SYSDATE - startup_time) * 24, 2) as uptime_hours
FROM v$instance;

-- Session activity
SELECT 
  status,
  COUNT(*) as session_count
FROM v$session
GROUP BY status;

-- Transaction volume
SELECT 
  TO_CHAR(SYSDATE, 'HH24:MI') as time_period,
  (SELECT value FROM v$sysstat WHERE name = 'user commits') as commits,
  (SELECT value FROM v$sysstat WHERE name = 'user rollbacks') as rollbacks
FROM dual;
```

#### Automated Monitoring Scripts
```sql
-- Create monitoring table
CREATE TABLE db_health_log (
  check_time TIMESTAMP,
  metric_name VARCHAR2(50),
  metric_value NUMBER,
  status VARCHAR2(20)
);

-- Monitoring procedure
CREATE OR REPLACE PROCEDURE monitor_database IS
  v_tablespace_pct NUMBER;
  v_session_count NUMBER;
BEGIN
  -- Check tablespace usage
  SELECT MAX(used_percent) INTO v_tablespace_pct
  FROM dba_tablespace_usage_metrics;
  
  INSERT INTO db_health_log VALUES (
    SYSTIMESTAMP, 'TABLESPACE_PCT', v_tablespace_pct,
    CASE WHEN v_tablespace_pct > 90 THEN 'CRITICAL'
         WHEN v_tablespace_pct > 80 THEN 'WARNING'
         ELSE 'OK' END
  );
  
  -- Check session count
  SELECT COUNT(*) INTO v_session_count FROM v$session WHERE type = 'USER';
  
  INSERT INTO db_health_log VALUES (
    SYSTIMESTAMP, 'SESSION_COUNT', v_session_count,
    CASE WHEN v_session_count > 100 THEN 'WARNING'
         ELSE 'OK' END
  );
  
  COMMIT;
END;
/
```

### Alert Log Monitoring

#### Alert Log Analysis
```bash
# Monitor alert log in real-time
tail -f $ORACLE_BASE/diag/rdbms/orcl/orcl/trace/alert_orcl.log

# Search for specific errors
grep -i "ORA-" alert_orcl.log | tail -20

# Extract daily errors
grep "$(date '+%a %b %d')" alert_orcl.log | grep "ORA-"
```

#### Automated Alert Processing
```bash
#!/bin/bash
# alert_monitor.sh - Monitor Oracle alert log for errors

ORACLE_BASE=/u01/app/oracle
ALERT_LOG=${ORACLE_BASE}/diag/rdbms/orcl/orcl/trace/alert_orcl.log
EMAIL_RECIPIENT="dba@company.com"
TEMP_FILE=/tmp/oracle_alerts.tmp

# Extract today's errors
grep "$(date '+%a %b %d')" $ALERT_LOG | grep "ORA-" > $TEMP_FILE

if [ -s $TEMP_FILE ]; then
    mail -s "Oracle Database Alerts - $(date)" $EMAIL_RECIPIENT < $TEMP_FILE
fi

rm -f $TEMP_FILE
```

---

## Best Practices and Standards

### Database Design Best Practices

#### Naming Conventions
```sql
-- Table naming: use plural nouns
CREATE TABLE employees (...);
CREATE TABLE departments (...);

-- Column naming: use descriptive names
employee_id, first_name, last_name, hire_date

-- Index naming: indicate purpose
idx_emp_dept_id, pk_emp_id, uk_emp_email

-- Constraint naming: indicate type and table
ck_emp_salary, fk_emp_dept_id, nn_emp_name
```

#### Table Design Standards
```sql
-- Include audit columns
CREATE TABLE employees (
  employee_id NUMBER(6) NOT NULL,
  first_name VARCHAR2(20) NOT NULL,
  last_name VARCHAR2(25) NOT NULL,
  email VARCHAR2(25) NOT NULL,
  hire_date DATE NOT NULL,
  salary NUMBER(8,2),
  department_id NUMBER(4),
  -- Audit columns
  created_by VARCHAR2(30) DEFAULT USER,
  created_date DATE DEFAULT SYSDATE,
  modified_by VARCHAR2(30),
  modified_date DATE,
  -- Constraints
  CONSTRAINT pk_employees PRIMARY KEY (employee_id),
  CONSTRAINT uk_emp_email UNIQUE (email),
  CONSTRAINT ck_emp_salary CHECK (salary > 0)
);
```

### Security Best Practices

#### User Account Management
```sql
-- Use principle of least privilege
-- Create application-specific users
CREATE USER app_readonly IDENTIFIED BY complex_password
DEFAULT TABLESPACE users
TEMPORARY TABLESPACE temp
QUOTA 0 ON users;

-- Grant only necessary privileges
GRANT CREATE SESSION TO app_readonly;
GRANT SELECT ON hr.employees TO app_readonly;

-- Use roles for privilege management
CREATE ROLE app_read_role;
GRANT SELECT ON hr.employees TO app_read_role;
GRANT SELECT ON hr.departments TO app_read_role;
GRANT app_read_role TO app_readonly;
```

#### Password Security
```sql
-- Implement strong password profiles
CREATE PROFILE strong_password_profile LIMIT
  PASSWORD_LIFE_TIME 90
  PASSWORD_GRACE_TIME 7
  PASSWORD_REUSE_TIME 365
  PASSWORD_REUSE_MAX 12
  FAILED_LOGIN_ATTEMPTS 5
  PASSWORD_LOCK_TIME 1
  PASSWORD_VERIFY_FUNCTION ora12c_strong_verify_function;
```

### Backup and Recovery Best Practices

#### Backup Strategy
```bash
# Implement 3-2-1 backup rule
# 3 copies of data, 2 different media types, 1 offsite

# Daily incremental backups
BACKUP INCREMENTAL LEVEL 1 DATABASE;

# Weekly full backups
BACKUP DATABASE PLUS ARCHIVELOG;

# Monthly archive to tape/cloud
BACKUP BACKUPSET ALL DELETE INPUT;
```

#### Recovery Testing
```sql
-- Regular recovery testing schedule
-- Quarterly: Test table recovery
-- Semi-annually: Test tablespace recovery  
-- Annually: Test full database recovery

-- Document recovery procedures
-- Maintain recovery runbooks
-- Train staff on recovery procedures
```

### Performance Best Practices

#### SQL Development Standards
```sql
-- Use bind variables
SELECT * FROM employees WHERE employee_id = :emp_id;

-- Avoid SELECT *
SELECT employee_id, first_name, last_name FROM employees;

-- Use appropriate indexes
CREATE INDEX idx_emp_dept_name ON employees(department_id, last_name);

-- Analyze execution plans
EXPLAIN PLAN FOR your_query;
SELECT * FROM TABLE(DBMS_XPLAN.DISPLAY);
```

#### Database Configuration
```sql
-- Set appropriate initialization parameters
-- Memory management
ALTER SYSTEM SET memory_target = 2G SCOPE=SPFILE;

-- Optimizer settings
ALTER SYSTEM SET optimizer_mode = ALL_ROWS;
ALTER SYSTEM SET cursor_sharing = EXACT;

-- Archive log management
ALTER SYSTEM SET log_archive_dest_1 = 'LOCATION=/u01/archive VALID_FOR=(ALL_LOGFILES,ALL_ROLES) DB_UNIQUE_NAME=primary';
```

---

## Conclusion

This comprehensive guide covers Oracle Database from beginner to professional level, including:

- **Architecture**: Understanding Oracle's physical and logical structures
- **Installation**: Various installation methods and configurations
- **Patching**: Keeping your database secure and up-to-date
- **Upgrades**: Planning and executing database upgrades
- **Administration**: Daily DBA tasks and maintenance
- **New Features**: Evolution of Oracle Database capabilities
- **Networking**: Connectivity and network optimization
- **Performance Tuning**: Optimizing database performance
- **Backup and Recovery**: Protecting your data
- **Security**: Implementing comprehensive security measures
- **Troubleshooting**: Diagnosing and resolving issues
- **Best Practices**: Industry standards and recommendations

### Continuous Learning Resources

1. **Oracle Documentation**: Official Oracle Database documentation
2. **My Oracle Support (MOS)**: Patches, bug reports, and solutions
3. **Oracle University**: Official training and certification
4. **Oracle Community**: Forums and user groups
5. **Oracle Blogs**: Technical blogs from Oracle experts
6. **Hands-on Practice**: Set up test environments for experimentation

### Key Takeaways

- Oracle Database is a complex but powerful platform
- Proper planning is essential for all major operations
- Regular monitoring and maintenance prevent issues
- Security should be implemented at all levels
- Performance tuning is an ongoing process
- Backup and recovery procedures must be tested regularly
- Stay current with patches and new features
- Document all procedures and configurations

Remember that becoming proficient with Oracle Database requires continuous learning and hands-on experience. Use this guide as a reference, but always test procedures in a development environment before applying them to production systems.',
    start_date      => SYSTIMESTAMP,
    repeat_interval => 'FREQ=DAILY;BYHOUR=2',
    enabled         => TRUE
  );
END;
/

-- Monitor jobs
SELECT job_name, state, last_start_date, next_run_date 
FROM dba_scheduler_jobs;

-- Job history
SELECT job_name, status, actual_start_date, run_duration 
FROM dba_scheduler_job_run_details 
WHERE job_name = 'CLEANUP_JOB' 
ORDER BY actual_start_date DESC;
```

---

## New Features by Version

### Oracle 12c New Features

#### Multitenant Architecture
- Container Database (CDB) and Pluggable Database (PDB)
- Resource management across containers
- Simplified patching and upgrades

```sql
-- Check container information
SELECT name, con_id, open_mode FROM v$containers;

-- Connect to PDB
ALTER SESSION SET CONTAINER = pdb1;

-- Create PDB
CREATE PLUGGABLE DATABASE pdb2 
ADMIN USER pdb_admin IDENTIFIED BY password
FILE_NAME_CONVERT = ('/u01/app/oracle/oradata/cdb/pdb1/', '/u01/app/oracle/oradata/cdb/pdb2/');
```

#### Enhanced Security
- Transparent Data Encryption improvements
- Data Redaction
- Privilege Analysis

```sql
-- Data Redaction example
BEGIN
  DBMS_REDACT.ADD_POLICY(
    object_schema   => 'HR',
    object_name     => 'EMPLOYEES',
    column_name     => 'SALARY',
    policy_name     => 'SALARY_REDACT',
    function_type   => DBMS_REDACT.PARTIAL,
    function_parameters => 'VVVFVVVFVVV,VVV-VV-VVVV,X'
  );
END;
/
```

### Oracle 18c New Features

#### Autonomous Database Features
- Self-driving, self-securing, self-repairing
- Machine learning integration
- Automatic indexing

#### Active Data Guard DML Redirection
```sql
-- Enable DML redirection on standby
ALTER DATABASE SET STANDBY DATABASE TO MAXIMIZE PERFORMANCE;
ALTER SYSTEM SET ADG_REDIRECT_DML = TRUE;
```

### Oracle 19c New Features

#### Automatic Indexing
```sql
-- Enable automatic indexing
ALTER SYSTEM SET AUTO_INDEX_MODE = IMPLEMENT;

-- Check auto index recommendations
SELECT * FROM DBA_AUTO_INDEX_EXECUTIONS;
```

#### Real-Time Statistics
```sql
-- Enable real-time statistics
ALTER SYSTEM SET OPTIMIZER_REAL_TIME_STATISTICS = TRUE;
```

#### Blockchain Tables
```sql
-- Create blockchain table
CREATE BLOCKCHAIN TABLE blockchain_ledger (
    id NUMBER,
    transaction_data VARCHAR2(100)
) NO DROP UNTIL 16 DAYS IDLE NO DELETE LOCKED;
```

### Oracle 21c New Features

#### Native JSON Binary Format
```sql
-- JSON binary format improvements
CREATE TABLE json_docs (
    id NUMBER,
    doc JSON
);

-- JSON aggregation functions
SELECT JSON_ARRAYAGG(employee_id) FROM employees;
```

#### Automatic Zone Maps
```sql
-- Automatic zone map creation
ALTER TABLE sales ENABLE ROW MOVEMENT;
ALTER TABLE sales ENABLE CLUSTERING sales_cluster_zone_map CASCADE;
```

---

## Networking

### Oracle Net Architecture

#### Listener Configuration
```bash
# listener.ora
LISTENER =
  (DESCRIPTION_LIST =
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = TCP)(HOST = hostname)(PORT = 1521))
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1521))
    )
  )

SID_LIST_LISTENER =
  (SID_LIST =
    (SID_DESC =
      (SID_NAME = ORCL)
      (ORACLE_HOME = /u01/app/oracle/product/19.0.0/dbhome_1)
    )
  )
```

#### TNS Configuration
```bash
# tnsnames.ora
ORCL =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = hostname)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SID = ORCL)
    )
  )

# Connect string format
hostname:1521/service_name
```

#### Listener Management
```bash
# Start listener
lsnrctl start listener_name

# Check listener status
lsnrctl status

# Reload listener configuration
lsnrctl reload

# Show services
lsnrctl services
```

### Connection Methods

#### Dedicated Server
- One server process per user session
- Higher memory usage but better performance for long-running sessions

#### Shared Server
```sql
-- Configure shared server
ALTER SYSTEM SET SHARED_SERVERS = 5;
ALTER SYSTEM SET MAX_SHARED_SERVERS = 20;
ALTER SYSTEM SET DISPATCHERS = '(PROTOCOL=TCP)(DISPATCHERS=3)';
```

#### Connection Pooling
```sql
-- Database Resident Connection Pooling (DRCP)
-- Configure DRCP
EXECUTE DBMS_CONNECTION_POOL.CONFIGURE_POOL(
  pool_name => 'SYS_DEFAULT_CONNECTION_POOL',
  minsize => 4,
  maxsize => 40,
  incrsize => 2,
  session_cached_cursors => 20,
  inactivity_timeout => 300,
  max_think_time => 600,
  max_use_session => 500000,
  max_lifetime_session => 86400
);

-- Start connection pool
EXECUTE DBMS_CONNECTION_POOL.START_POOL('SYS_DEFAULT_CONNECTION_POOL');
```

### Security Configuration

#### SSL/TLS Configuration
```bash
# Create wallet
orapki wallet create -wallet /u01/app/oracle/wallet -pwd password123

# Add certificate
orapki wallet add -wallet /u01/app/oracle/wallet -trusted_cert -cert server.crt -pwd password123

# Configure listener for SSL
LISTENER_SSL =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCPS)(HOST = hostname)(PORT = 2484))
  )

SSL_CLIENT_AUTHENTICATION = FALSE
WALLET_LOCATION =
  (SOURCE =
    (METHOD = FILE)
    (METHOD_DATA =
      (DIRECTORY = /u01/app/oracle/wallet)
    )
  )
```

### Network Troubleshooting

#### Common Network Issues
```bash
# Test connectivity
tnsping service_name

# Check listener log
tail -f $ORACLE_HOME/network/log/listener.log

# Enable SQL*Net tracing
# In sqlnet.ora
TRACE_LEVEL_CLIENT = 16
TRACE_DIRECTORY_CLIENT = /tmp
TRACE_FILE_CLIENT = client_trace
```

#### Network Performance Tuning
```bash
# Optimize SDU and TDU
# In tnsnames.ora
(SDU=32767)(TDU=32767)

# Connection timeout settings
SQLNET.INBOUND_CONNECT_TIMEOUT = 60
SQLNET.RECV_TIMEOUT = 30
```

---

## Performance Tuning

### SQL Tuning

#### Execution Plan Analysis
```sql
-- Explain plan
EXPLAIN PLAN FOR
SELECT * FROM employees WHERE department_id = 50;

SELECT * FROM TABLE(DBMS_XPLAN.DISPLAY);

-- Autotrace
SET AUTOTRACE ON EXPLAIN STATISTICS

-- SQL monitoring
SELECT sql_id, status, elapsed_time, cpu_time 
FROM v$sql_monitor 
WHERE sql_text LIKE '%employees%';
```

#### SQL Plan Management
```sql
-- Create SQL Plan Baseline
DECLARE
  l_plans_loaded PLS_INTEGER;
BEGIN
  l_plans_loaded := DBMS_SPM.LOAD_PLANS_FROM_CURSOR_CACHE(
    sql_id => 'abc123def456'
  );
END;
/

-- Check SQL Plan Baselines
SELECT sql_handle, plan_name, enabled, accepted 
FROM dba_sql_plan_baselines;
```

### Index Optimization

#### Index Types and Usage
```sql
-- B-Tree Index
CREATE INDEX idx_emp_dept ON employees(department_id);

-- Composite Index
CREATE INDEX idx_emp_name_dept ON employees(last_name, department_id);

-- Function-based Index
CREATE INDEX idx_emp_upper_name ON employees(UPPER(last_name));

-- Partial Index
CREATE INDEX idx_emp_active ON employees(employee_id) 
WHERE status = 'ACTIVE';

-- Check index usage
SELECT name, used FROM v$object_usage WHERE name = 'IDX_EMP_DEPT';
```

### Memory Tuning

#### Buffer Cache Tuning
```sql
-- Buffer cache hit ratio
SELECT 
  ROUND((1 - (phyrds + phyblkrd) / (db_block_gets + consistent_gets)) * 100, 2) as hit_ratio
FROM 
  (SELECT value phyrds FROM v$sysstat WHERE name = 'physical reads'),
  (SELECT value phyblkrd FROM v$sysstat WHERE name = 'physical reads direct'),  
  (SELECT value db_block_gets FROM v$sysstat WHERE name = 'db block gets'),
  (SELECT value consistent_gets FROM v$sysstat WHERE name = 'consistent gets');

-- Buffer cache advisory
SELECT size_for_estimate, buffers_for_estimate, estd_physical_read_factor
FROM v$db_cache_advice 
WHERE name = 'DEFAULT' AND block_size = 8192;
```

#### Shared Pool Tuning
```sql
-- Shared pool statistics
SELECT 
  pool,
  name,
  bytes/1024/1024 as mb
FROM v$sgastat 
WHERE pool = 'shared pool';

-- Library cache hit ratio
SELECT 
  namespace,
  ROUND(pinhitratio * 100, 2) as pin_hit_ratio,
  ROUND(gethitratio * 100, 2) as get_hit_ratio
FROM v$librarycache;
```

### I/O Tuning

#### I/O Statistics
```sql
-- I/O statistics by tablespace
SELECT 
  ts.name as tablespace,
  df.file_name,
  fs.phyrds,
  fs.phywrts,
  fs.readtim,
  fs.writetim
FROM v$filestat fs, v$datafile df, v$tablespace ts
WHERE fs.file# = df.file# AND df.ts# = ts.ts#;

-- Wait events related to I/O
SELECT event, total_waits, time_waited, average_wait
FROM v$system_event
WHERE event LIKE '%read%' OR event LIKE '%write%'
ORDER BY time_waited DESC;
```

### AWR and ASH Analysis

#### AWR Reports
```sql
-- Generate AWR report
@$ORACLE_HOME/rdbms/admin/awrrpt.sql

-- AWR snapshot management
EXEC DBMS_WORKLOAD_REPOSITORY.CREATE_SNAPSHOT();

-- Modify AWR settings
EXEC DBMS_WORKLOAD_REPOSITORY.MODIFY_SNAPSHOT_SETTINGS(
  retention => 10080,  -- 7 days in minutes
  interval => 30       -- 30 minutes
);
```

#### ASH Analysis
```sql
-- Top SQL by CPU time
SELECT 
  sql_id,
  COUNT(*) as samples,
  ROUND(COUNT(*) * 100 / SUM(COUNT(*)) OVER(), 2) as pct
FROM v$active_session_history
WHERE sample_time > SYSDATE - 1/24
  AND session_state = 'ON CPU'
GROUP BY sql_id
ORDER BY samples DESC;

-- Wait events analysis
SELECT 
  event,
  COUNT(*) as waits,
  ROUND(AVG(time_waited), 2) as avg_wait_time
FROM v$active_session_history
WHERE sample_time > SYSDATE - 1/24
  AND event IS NOT NULL
GROUP BY event
ORDER BY waits DESC;
```

---

## Backup and Recovery

### RMAN Backup Strategies

#### Full Database Backup
```bash
# Connect to RMAN
rman target /

# Full database backup
BACKUP DATABASE PLUS ARCHIVELOG;

# Incremental backup
BACKUP INCREMENTAL LEVEL 0 DATABASE;
BACKUP INCREMENTAL LEVEL 1 DATABASE;

# Compressed backup
BACKUP AS COMPRESSED BACKUPSET DATABASE;
```

#### Tablespace and Datafile Backup
```bash
# Tablespace backup
BACKUP TABLESPACE users;

# Datafile backup
BACKUP DATAFILE 4;

# Control file backup
BACKUP CURRENT CONTROLFILE;

# SPFILE backup
BACKUP SPFILE;
```

#### RMAN Configuration
```bash
# Configure backup settings
CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 7 DAYS;
CONFIGURE DEFAULT DEVICE TYPE TO DISK;
CONFIGURE CONTROLFILE AUTOBACKUP ON;
CONFIGURE BACKUP OPTIMIZATION ON;
CONFIGURE COMPRESSION ALGORITHM 'MEDIUM';

# Show configuration
SHOW ALL;
```

### Recovery Scenarios

#### Complete Database Recovery
```bash
# Restore and recover database
RMAN TARGET /
STARTUP MOUNT;
RESTORE DATABASE;
RECOVER DATABASE;
ALTER DATABASE OPEN;
```

#### Point-in-Time Recovery
```bash
# Recover to specific time
STARTUP MOUNT;
SET UNTIL TIME "TO_DATE('2024-01-15 14:00:00','YYYY-MM-DD HH24:MI:SS')";
RESTORE DATABASE;
RECOVER DATABASE;
ALTER DATABASE OPEN RESETLOGS;
```

#### Tablespace Point-in-Time Recovery (TSPITR)
```bash
# TSPITR using RMAN
RECOVER TABLESPACE users 
UNTIL TIME "TO_DATE('2024-01-15 12:00:00','YYYY-MM-DD HH24:MI:SS')"
AUXILIARY DESTINATION '/u01/app/oracle/aux';
```

### Data Pump (expdp/impdp)

#### Export Operations
```bash
# Full database export
expdp system/password full=y directory=DATA_PUMP_DIR dumpfile=fulldb.dmp logfile=fulldb.log

# Schema export
expdp hr/password schemas=hr directory=DATA_PUMP_DIR dumpfile=hr_schema.dmp

# Table export
expdp hr/password tables=employees directory=DATA_PUMP_DIR dumpfile=employees.dmp

# Query-based export
expdp hr/password tables=employees query='WHERE department_id=50' directory=DATA_PUMP_DIR dumpfile=dept50_emp.dmp
```

#### Import Operations
```bash
# Full database import
impdp system/password full=y directory=DATA_PUMP_DIR dumpfile=fulldb.dmp

# Schema import with remap
impdp system/password schemas=hr directory=DATA_PUMP_DIR dumpfile=hr_schema.dmp remap_schema=hr:hr_copy

# Table import
impdp hr/password tables=employees directory=DATA_PUMP_DIR dumpfile=employees.dmp

# Network import
impdp hr/password network_link=source_db schemas=hr
```

### Flashback Technology

#### Flashback Query
```sql
-- Query data as of specific time
SELECT * FROM employees 
AS OF TIMESTAMP (SYSTIMESTAMP - INTERVAL '1' HOUR)
WHERE employee_id = 100;

-- Flashback version query
SELECT employee_id, salary, versions_starttime, versions_endtime
FROM employees 
VERSIONS BETWEEN TIMESTAMP 
  (SYSTIMESTAMP - INTERVAL '2' HOUR) AND SYSTIMESTAMP
WHERE employee_id = 100;
```

#### Flashback Table
```sql
-- Enable row movement
ALTER TABLE employees ENABLE ROW MOVEMENT;

-- Flashback table
FLASHBACK TABLE employees TO TIMESTAMP 
  (SYSTIMESTAMP - INTERVAL '1' HOUR);

-- Flashback to before drop
FLASHBACK TABLE employees TO BEFORE DROP;
```

#### Flashback Database
```sql
-- Configure flashback database
ALTER DATABASE FLASHBACK ON;

-- Create restore point
CREATE RESTORE POINT before_upgrade;

-- Flashback database
SHUTDOWN IMMEDIATE;
STARTUP MOUNT;
FLASHBACK DATABASE TO RESTORE POINT before_upgrade;
ALTER DATABASE OPEN RESETLOGS;
```

---

## Security

### User Authentication

#### Password Management
```sql
-- Create password profile
CREATE PROFILE secure_profile LIMIT
  PASSWORD_LIFE_TIME 60
  PASSWORD_GRACE_TIME 7
  PASSWORD_REUSE_TIME 365
  PASSWORD_REUSE_MAX 5
  FAILED_LOGIN_ATTEMPTS 3
  PASSWORD_LOCK_TIME 1/24
  PASSWORD_VERIFY_FUNCTION ora12c_verify_function;

-- Assign profile to user
ALTER USER hr PROFILE secure_profile;

-- Check password profiles
SELECT username, profile, account_status FROM dba_users;
```

#### External Authentication
```sql
-- Create externally authenticated user
CREATE USER ops$oracle IDENTIFIED EXTERNALLY;

-- LDAP authentication setup
CREATE USER "CN=John Smith,OU=Users,DC=company,DC=com" 
IDENTIFIED GLOBALLY AS 'CN=John Smith,OU=Users,DC=company,DC=com';
```

### Privilege Management

#### System and Object Privileges
```sql
-- Grant system privileges
GRANT CREATE SESSION, CREATE TABLE TO developer_role;

-- Grant object privileges
GRANT SELECT, INSERT, UPDATE ON hr.employees TO app_user;

-- Create and manage roles
CREATE ROLE hr_manager;
GRANT SELECT, INSERT, UPDATE, DELETE ON hr.employees TO hr_manager;
GRANT hr_manager TO user1;

-- Check privileges
SELECT * FROM dba_sys_privs WHERE grantee = 'HR_MANAGER';
SELECT * FROM dba_tab_privs WHERE grantee = 'HR_MANAGER';
```

#### Fine-Grained Access Control (FGAC)
```sql
-- Create security policy
BEGIN
  DBMS_RLS.ADD_POLICY(
    object_schema   => 'hr',
    object_name     => 'employees',
    policy_name     => 'emp_security_policy',
    function_schema => 'security',
    policy_function => 'employee_security',
    statement_types => 'select,insert,update,delete'
  );
END;
